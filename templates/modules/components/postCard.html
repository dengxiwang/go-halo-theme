<!-- post-card.html -->
<div th:fragment="post-card(post)" class="relative flex overflow-hidden rounded-lg border bg-white transition-all">
  <!-- 内容区 -->

  <!-- 样式一：默认 -->
  <div
    class="flex flex-1 flex-col justify-between p-4"
    th:if="${theme.config.post.postListCardStyle == null or theme.config.post.postListCardStyle == 'default'}"
  >
    <a
      th:href="@{${post.status.permalink}}"
      class="group flex h-full flex-1 gap-1 pb-3 transition-all duration-300 hover:text-blue-500"
    >
      <div class="flex flex-1 flex-col gap-1">
        <!-- 标题 -->
        <h1 class="line-clamp-1 font-medium max-sm:line-clamp-2">
          <span
            th:if="${post.spec.pinned != null and post.spec.pinned}"
            class="mr-1 text-nowrap rounded bg-red-500 px-1.5 py-0.5 text-xs font-medium text-white"
            >置顶</span
          >
          <span
            class="align-middle text-lg"
            th:text="${post.spec != null and post.spec.title != null ? post.spec.title : '无标题'}"
          ></span>
        </h1>
        <div class="flex space-x-2">
          <div class="flex-1">
            <!-- 摘要 -->
            <span
              class="line-clamp-3 text-sm leading-6 opacity-50"
              th:text="${post.status != null and post.status.excerpt != null ? post.status.excerpt : '暂无摘要信息'}"
            >
            </span>
          </div>
          <!-- 封面图 -->
          <div
            th:if="${post.spec != null and post.spec.cover != null and post.spec.cover != ''}"
            class="relative overflow-hidden bg-gray-100"
            style="width: 128px; height: 72px"
          >
            <img
              th:src="${post.spec.cover}"
              th:alt="${post.spec.title != null ? post.spec.title : '文章封面'}"
              class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.15]"
            />
          </div>
        </div>
      </div>
    </a>

    <!-- 底部信息 -->
    <div class="flex flex-wrap items-center gap-4 gap-y-2 border-t pt-4 text-xs font-medium">
      <!-- 作者 -->
      <span
        class="opacity-50"
        th:text="${post.owner != null and post.owner.displayName != null ? '作者：' + post.owner.displayName : '作者：匿名用户'}"
      >
      </span>

      <!-- 发布时间 -->
      <time
        class="opacity-50"
        th:text="${post.spec != null and post.spec.publishTime != null ?
                            '发布时间：' + #dates.format(post.spec.publishTime, 'yyyy-MM-dd') :
                            '发布时间：未知时间'}"
      >
      </time>

      <!-- 分类 & 标签 -->
      <div
        th:if="${post.categories != null and #lists.size(post.categories) > 0} or ${post.tags != null and #lists.size(post.tags) > 0}"
        class="flex flex-wrap items-center gap-4 gap-y-2"
      >
        <!-- 分类 -->
        <div th:if="${post.categories != null and #lists.size(post.categories) > 0}">
          <span class="-mr-1 opacity-50">分类：</span>
          <span
            th:each="category, iterStat : ${post.categories != null ? post.categories : T(java.util.Collections).emptyList()}"
            th:if="${category.spec.displayName != null and category.status != null and category.status.permalink != null}"
          >
            <a
              th:href="@{${category.status.permalink}}"
              class="opacity-50 transition-all duration-300 hover:text-blue-500 hover:opacity-100"
            >
              <span th:text="${category.spec.displayName}"></span>
            </a>
            <span th:if="${!iterStat.last}" class="opacity-50">,</span>
          </span>
        </div>

        <!-- 标签 -->
        <div class="flex items-center" th:if="${post.tags != null and #lists.size(post.tags) > 0}">
          <span class="opacity-50">标签：</span>
          <span
            th:each="tag, iterStat : ${post.tags != null ? post.tags : T(java.util.Collections).emptyList()}"
            th:if="${tag.spec.displayName != null and tag.status != null and tag.status.permalink != null}"
          >
            <a
              th:href="@{${tag.status.permalink}}"
              class="opacity-50 transition-all duration-300 hover:text-blue-500 hover:opacity-100"
            >
              #<span th:text="${tag.spec.displayName}"></span>
            </a>
            <span th:if="${!iterStat.last}" class="opacity-50">,</span>
          </span>
          <!-- 无有效标签时显示默认 -->
          <span th:if="${post.tags == null or #lists.isEmpty(post.tags)}" class="opacity-50">#无标签</span>
        </div>
      </div>
    </div>
  </div>

  <!-- 样式二 -->
  <div class="flex flex-1 cursor-pointer gap-4 p-4" th:if="${theme.config.post.postListCardStyle == 'left-img'}">
    <!-- 左图 -->
    <div class="relative overflow-hidden rounded-md bg-gray-100" style="width: 40%; height: 100%">
      <a th:href="@{${post.status.permalink}}" title="点击跳转">
        <img
          th:src="${post.spec.cover ?: theme.config.post.defaultCoverImg}"
          th:alt="${post.spec.title != null ? post.spec.title : '文章封面'}"
          class="absolute h-full w-full object-cover transition-transform duration-500 hover:scale-[1.15]"
        />
      </a>
    </div>

    <!-- 右文章信息 -->
    <div class="flex flex-col justify-between" style="width: 60%; height: 100%">
      <a
        th:href="@{${post.status.permalink}}"
        class="flex h-full flex-1 flex-col gap-1 pb-3 transition-all duration-300 hover:text-blue-500 max-sm:pb-0"
      >
        <!-- 标题 -->
        <h1 class="line-clamp-2 font-medium">
          <span
            th:if="${post.spec.pinned != null and post.spec.pinned}"
            class="mr-1 text-nowrap rounded bg-red-500 px-1.5 py-0.5 text-xs font-medium text-white"
            >置顶</span
          >
          <span
            class="align-middle text-lg max-sm:text-base"
            th:text="${post.spec != null and post.spec.title != null ? post.spec.title : '无标题'}"
          ></span>
        </h1>

        <!-- 摘要 -->
        <span
          class="line-clamp-3 text-sm leading-6 opacity-50 max-sm:line-clamp-2"
          th:text="${post.status != null and post.status.excerpt != null ? post.status.excerpt : '暂无摘要信息'}"
        >
        </span>
      </a>

      <!-- 底部信息 -->
      <div class="flex flex-wrap items-center gap-4 gap-y-2 border-t pt-4 text-xs font-medium max-sm:hidden">
        <!-- 作者 -->
        <span
          class="opacity-50"
          th:text="${post.owner != null and post.owner.displayName != null ? '作者：' + post.owner.displayName : '作者：匿名用户'}"
        >
        </span>

        <!-- 发布时间 -->
        <time
          class="opacity-50"
          th:text="${post.spec != null and post.spec.publishTime != null ?
                                '发布时间：' + #dates.format(post.spec.publishTime, 'yyyy-MM-dd') :
                                '发布时间：未知时间'}"
        >
        </time>

        <!-- 分类 & 标签 -->
        <div
          th:if="${post.categories != null and #lists.size(post.categories) > 0} or ${post.tags != null and #lists.size(post.tags) > 0}"
          class="flex flex-wrap items-center gap-4 gap-y-2"
        >
          <!-- 分类 -->
          <div th:if="${post.categories != null and #lists.size(post.categories) > 0}">
            <span class="opacity-50">分类：</span>
            <span
              th:each="category, iterStat : ${post.categories != null ? post.categories : T(java.util.Collections).emptyList()}"
              th:if="${category.spec.displayName != null and category.status != null and category.status.permalink != null}"
            >
              <a
                th:href="@{${category.status.permalink}}"
                class="opacity-50 transition-all duration-300 hover:text-blue-500 hover:opacity-100"
              >
                <span th:text="${category.spec.displayName}"></span>
              </a>
              <span th:if="${!iterStat.last}" class="opacity-50">,</span>
            </span>
          </div>

          <!-- 标签 -->
          <div th:if="${post.tags != null and #lists.size(post.tags) > 0}">
            <span class="opacity-50">标签：</span>
            <span
              th:each="tag, iterStat : ${post.tags != null ? post.tags : T(java.util.Collections).emptyList()}"
              th:if="${tag.spec.displayName != null and tag.status != null and tag.status.permalink != null}"
            >
              <a
                th:href="@{${tag.status.permalink}}"
                class="opacity-50 transition-all duration-300 hover:text-blue-500 hover:opacity-100"
              >
                #<span th:text="${tag.spec.displayName}"></span>
              </a>
              <span th:if="${!iterStat.last}" class="opacity-50">,</span>
            </span>
            <!-- 无有效标签时显示默认 -->
            <span th:if="${post.tags == null or #lists.isEmpty(post.tags)}" class="opacity-50">#无标签</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
